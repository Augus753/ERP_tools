# ERP_tools
**erp工具集**
## 运行环境
### 本软件可在win64位机器运行
- 基于python embed，不需要用户安装运行环境
- 不要修改python-3.6.5-embed-amd64文件夹的内容

## 运行
- 选单软件order_pick   
鼠标双击 run_order_pick.bat文件

## 选单软件order_pick
#### 输入与输出
- 该软件输入与输出数据格式与excel模型兼容
##### 输入
- 计划产能数据
```text
	日期	库存	6.29	8.17	10.05	11.23	5.29	4.17	3.05	2.23	1.23	5.23
	P1	0	8	8	8	2	0	0	0	0	5	0
	P2	0	0	0	0	0	0	0	0	0	0	0
	P3	0	0	0	0	0	0	0	0	0	0	0
	P4	0	0	0	0	0	0	0	0	0	0	0
	P5	0	0	0	0	0	0	0	0	0	0	0

	日期	库存	6.29	8.17	10.05	11.23	5.29	4.17
	P1	2	4	4	4	0	0	4
	P2	0	0	0	0	8	0	0
	P3	0	0	0	0	0	8	4
	P4	0	0	0	0	0	0	0
	P5	0	0	0	0	0	0	0



日期	库存	6.29	8.17
	P1	2	4	4
	P2	0	4	4
	P3	0	0	0
	P4	0	0	0
	P5	0	0	0
	
	
	
日期	库存	1.29	2.17
	P1	2	4	4
	P2	0	4	4
	P3	0	0	0
	P4	0	0	0
	P5	0	0	0
```
- 订单数据
产品	数量	总额	交货期	账期	实际交货期  
交货期格式：月.日 如1月1日：1.01
- 产品暂时只支持P1、P2、P3、P4、P5

##### 输出
默认在ERP_tools文件夹下输出订单信息，名称为**订单列表.xlsx**

### 操作流程
#### 1、输入计划产能数据
     点击输入完成
     点击生成模型按钮
![image](https://github.com/Augus753/ERP_tools/blob/feature/order_pick/image/bar_show.jpg)
#### 2、选单过程中
     完整的输入订单信息
     点击插入订单按钮
- 需要输入完整的订单信息
- 每输入一个订单，右边产品数量表都会自动更新
#### 3、点击查看订单按钮
弹出订单列表界面，点击菜单栏下载订单按钮，可生成订单数据，默认在当前文件目录下生成文件**订单列表.xlsx**
![image](https://github.com/Augus753/ERP_tools/blob/feature/order_pick/image/order_list.jpg)

#### 4、参数设置
点击工具栏参数设置，进入设置界面，双击数据就能修改参数
- 可供修改的参数，生产周期、订单保存路径
![image](https://github.com/Augus753/ERP_tools/blob/feature/order_pick/image/order_config.jpg)

### 相关策略说明
#### 图表说明
- 包括当前交货期最大可交产品数、当前交货期计划各产品产能数
两个图表，图表内容会随计划产能数和订单信息实时变化，用户参
照该图表可更容易的选单
- 最大可交产品数：从第一期到当前交货期累计的产品总数
- 前交货期计划各产品产能数：从上一个交货期到当前交货期生产
的各个产品数量
- 若从上一个交货期到当前交货期生产总产品数量已被分配完，
则从图表中移除该交货期，之后的订单也不会分配在该交货期中
#### 交货逻辑
- 选择订单交货期往前检测各个交货期
- 优先选择该交货期里相同产品数交单，若数量不够，则选择其他产品
- 若该交货期已无可交产品数，则往前查看上一个交货期
- 在（1.00 + 生产周期）之间的交货期里的产品为上一年度已开始生产
的产品，因此，该部分的交单时，只按相同产品数交单，不足则认为交单失败

## 决策日历
### 生成决策日历函数
decision_calendar

